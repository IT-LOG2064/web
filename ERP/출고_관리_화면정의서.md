# 출고 관리

## 1. 화면 개요

### 1.1 기본 정보

- **화면명**: 출고 관리
- **목적**: 출고 목록 조회/검색, 출고 상세 확인, 신규 출고 등록, 출고 확인(서명) 처리

---

## 2. 탭 구성

2개의 탭으로 구성됨:

- **탭 1: 출고 목록** (기본)
- **탭 2: 출고 등록**

---

## 3. 탭 1: 출고 목록

### 3.1 초기 로드

- 전체 출고 목록 조회
- 최신순 정렬
- 페이징 적용

### 3.2 검색/필터 영역

**필터 옵션:**

- 현장 전체 / 강남 오피스텔 / 판교 공장 / 인천 물류센터 등
- 기간 전체 / 오늘 / 이번 주 / 이번 달

**검색 대상:**

- 출고번호 / 발주번호 / 자재명
- 통합 검색 (OR 조건)

**[선출고만 보기] 체크박스:**

- 선출고(발주 미연결) 출고 건만 필터링

**[초기화] 버튼:** 모든 필터 초기화 후 전체 재조회

### 3.3 요약 영역

```
전체: 85건 | 완료: 72건 | 진행중: 13건
```

**[+ 신규 출고] 버튼:**

- 출고 등록 탭으로 전환

### 3.4 목록 테이블

**컬럼 구조:**

| 컬럼명 | 표시 내용 | 비고 |
| --- | --- | --- |
| 출고 번호 | OUT-2024-050 | 굵게 표시 |
| 발주 | IT260115-01 | 링크 / 선출고 시 "선출고" 뱃지 표시 |
| 현장 | 강남 오피스텔 |  |
| 자재 | 3종 54개 |  |
| 출고일 | 2024-02-03 |  |
| 담당자 | 이출고 |  |
| 작업 | [출고확인] [출고증 출력] |  |

**행 클릭:** 출고 상세 모달 오픈

**발주 링크 클릭:**

- `event.stopPropagation()` - 행 클릭 이벤트 차단
- 해당 발주 상세로 이동

**선출고 뱃지:** 발주 미연결 출고 건에 주황색 "선출고" 뱃지 표시

### 3.5 페이지네이션

- ◀ 1 2 3 ▶

---

## 4. 탭 2: 출고 등록

### 4.1 카드 1: 출고 기본정보 (현장/발주 선택)

**검색:**

- 통합 검색 입력: 본사, 현장 또는 발주번호 검색
- 자동완성 드롭다운 표시

**현장 선택* (필수):**

- 드롭다운: 등록된 현장 목록 (형식: "현장명 (본사명)")
- 선택 시 해당 현장의 발주 목록 로드

**발주 선택 (선출고 가능):**

- 드롭다운: 선택한 현장의 발주 목록
- 현장 미선택 시 비활성화 + "현장을 먼저 선택해주세요" 표시
- 선택 시 발주 정보 박스 표시
- 선출고 옵션 포함

**발주 정보 박스 (선택 후 표시):**

- 발주 기본 정보
- 발주 진행률 정보 (출고 현황)

**최근 발주 건 (2주 이내):**

- [최근 발주 건 선택] 버튼 → 최근 발주 선택 모달 오픈

### 4.2 카드 2: 출고 정보

**출고 번호:**

- 자동 생성 (편집 불가), 표시 형식: "OUT-2024-051 (자동 생성)"

**출고 일시* (필수):**

- datetime-local, 기본값: 현재 일시

**비고:**

- 텍스트 입력, 출고 관련 특이사항

**선출고 사유 (조건부 표시):**

- 발주 미선택 또는 선출고 시에만 표시
- 필수 입력

### 4.3 카드 3: AS 출고 자재 선택 (조건부 표시)

**표시 조건:** 현장 선택 후 해당 현장의 AS 건이 존재하는 경우만 표시

**AS 자재 목록:**

| 컬럼 | 내용 |
| --- | --- |
| 선택 체크박스 |  |
| 자재 코드 |  |
| 자재명 |  |
| 규격 |  |
| AS 입고 수량 |  |
| 출고 수량 | 편집 가능 |
| 소유구분 | 판매/임대/바이백 선택 |
| 시리얼 | 시리얼 선택 |

**[출고 목록에 추가] 버튼:**

- 선택한 AS 자재를 출고 자재 목록에 추가

### 4.4 카드 4: 출고 자재 선택

**자재 검색:**

- 자재 코드, 자재명, 카테고리로 자동완성 검색
- [자재검색] 버튼으로 자재 검색 모달 오픈

**자재 검색 모달:**

- 대분류 필터: CCTV, 네트워크, 케이블, 부자재, 기타
- 소분류 필터: 대분류 선택 시 활성화 (예: CCTV > 녹화기, 모니터)
- 키워드 검색: 자재 코드, 자재명, 규격
- 시리얼 관리 여부 표시
- 다중 선택 가능

**출고 자재 목록:**

- 발주 선택 시 발주 자재 자동 로드
- 추가/수정 가능

| 컬럼 | 내용 |
| --- | --- |
| 자재 코드 |  |
| 자재명 |  |
| 규격 |  |
| 발주/기출고 | 발주 수량 / 기출고 수량 |
| 출고 수량 | 편집 가능 |
| 품질 | 신품/중고 |
| 시리얼 여부 | 시리얼 관리 여부 표시 |
| 시리얼 | 시리얼 선택 링크 |
| 삭제 | 삭제 버튼 |

**발주 잔여 수량 초과 시:**

- 출고 수량이 발주 잔여 수량을 초과하는 경우
- 해당 자재 행 아래에 주황색 배경의 사유 입력 행 추가
- 사유 입력 필수 (출고 등록 시 검증)

### 4.5 하단 버튼

- [취소]: 목록 탭으로 전환
- [출고 등록]: 출고 처리

---

## 5. 출고 상세 모달

### 5.1 오픈 조건

- 목록 행 클릭

### 5.2 표시 정보

**기본 정보:**

- 출고 번호
- 발주 (링크 또는 "선출고" 뱃지)
- 현장
- 출고일
- 담당자
- 상태 (뱃지)

**선출고 사유 박스 (조건부 표시):**

- 선출고 건인 경우 주황색 박스로 표시
- 선출고 사유 내용 표시

**출고 자재 목록:**

| 컬럼 | 내용 |
| --- | --- |
| 자재 코드 |  |
| 자재명 |  |
| 수량 |  |
| 소유구분 | 소유/임대/바이백 |
| 품질 | 신품/중고 |
| 시리얼 | 시리얼 목록 보기 링크 |

### 5.3 버튼

- [출고증 출력]: 출고증 출력
- [닫기]: 모달 닫기

---

## 6. 출고 확인 모달

### 6.1 오픈 조건

- 목록의 [출고확인] 버튼 클릭

### 6.2 표시 정보

**기본 정보 (읽기 전용):**

- 출고 번호
- 발주 (링크)
- 현장
- 출고일
- 담당자

**출고 자재 목록:**

| 컬럼 | 내용 |
| --- | --- |
| 자재 코드 |  |
| 자재명 |  |
| 수량 |  |
| 품질 |  |
| 시리얼 | 시리얼 목록 보기 링크 |

**출고 확인 서명:**

- 서명 패드 (Canvas): 마우스/터치 서명 가능
- [지우기] 버튼: 서명 초기화
- 안내 문구: "마우스 또는 터치로 서명해 주세요."

### 6.3 [출고확인 완료] 버튼

**동작:**

1. 서명 데이터 저장
2. 출고 상태 "완료"로 변경
3. 성공 알림
4. 모달 닫기, 목록 상태 갱신

### 6.4 [취소] 버튼

- 모달 닫기, 변경사항 없음

---

## 7. 비즈니스 규칙

### 7.1 출고 번호 생성

- 자동 생성
- 형식: OUT-YYYY-NNN (예: OUT-2024-051)

### 7.2 선출고

- 발주와 연결되지 않은 출고
- 목록에서 "선출고" 뱃지 표시
- 선출고 사유 필수 입력

### 7.3 발주 잔여 수량 초과

- 출고 등록 시 발주 잔여 수량을 초과하는 경우
- 자재별로 초과 사유 입력 필수
- 재고 관리 및 발주 진행률 추적 목적

### 7.4 재고 연동

- 출고 등록 시 해당 자재 재고 자동 감소
- 시리얼 관리 자재: 시리얼 상태 "출고됨"으로 변경

### 7.5 AS 자재 출고

- 현장의 AS 완료 자재를 재출고할 때 사용
- 교체출고 여부 기록

---

## 8. 유효성 검증

### 8.1 출고 등록 필수 필드

- 현장
- 발주 (선출고 시 면제, 대신 선출고 사유 필수)
- 출고 일시
- 출고 자재 (최소 1개)

### 8.2 선출고 사유

- 발주 미연결 시 필수

### 8.3 발주 잔여 수량 초과 사유

- 자재별 발주 잔여 수량 초과 시 필수

### 8.4 자재 수량

- 1 이상 숫자만 입력 가능

---

## 9. 에러 처리

| 상황 | 메시지 |
| --- | --- |
| 현장 미선택 | "현장을 선택해주세요." |
| 자재 미추가 | "출고 자재를 추가해주세요." |
| 선출고 사유 미입력 | "선출고 사유를 입력해주세요." |
| 잔여 수량 초과 사유 미입력 | "모든 초과 출고 항목의 사유를 입력해주세요." |
| 수량 오류 | "올바른 수량을 입력해주세요." |

---

## 10. 개발 체크리스트

### 10.1 필수 구현 사항

- [ ]  출고 목록 조회 및 필터링
- [ ]  선출고만 보기 필터
- [ ]  출고 상세 조회
- [ ]  출고 등록 (현장/발주 선택 + 자재 편집)
- [ ]  자재 검색 모달 (대분류/소분류 필터)
- [ ]  AS 자재 선택 (조건부 표시)
- [ ]  출고 확인 (서명 패드)
- [ ]  출고증 출력
- [ ]  페이지네이션

### 10.2 비즈니스 로직

- [ ]  출고 번호 자동 생성
- [ ]  현장 선택 → 발주 목록 동적 로드
- [ ]  발주 선택 → 자재 목록 자동 로드
- [ ]  선출고 감지 및 사유 입력 필드 표시
- [ ]  발주 잔여 수량 초과 시 자재별 사유 입력 행 추가
- [ ]  출고 수량 변경 시 실시간 잔여 수량 초과 체크
- [ ]  출고 시 재고 자동 감소
- [ ]  시리얼 상태 자동 변경
- [ ]  서명 패드 구현 (Canvas)
- [ ]  자동완성 검색 (발주/자재)
- [ ]  자재 검색 모달 대분류/소분류 필터링

---

## 11. 관련 화면

- 발주 관리: 발주 기준 자재 목록 참조, 발주 총량 대비 출고 현황 관리
- 재고 관리: 출고 시 재고 자동 감소
- 입고 관리: 현장 회수 시 연동
- 현장 통합 현황: 출고 이력 및 발주 대비 출고 현황 반영

---
