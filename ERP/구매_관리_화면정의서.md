# 구매 관리

## 1. 화면 개요

### 1.1 기본 정보

- **화면명**: 구매 관리
- **목적**: 자재 구매 요청 목록 조회/검색, 구매 상세 확인, 신규 구매 요청 등록, 입고 처리

> ⚠️ **참고**: 현재 네비게이션에서 주석 처리되어 있음. 추후 활성화 예정.

---

## 2. 초기 로드

### 2.1 초기 데이터 로드

- 전체 구매 목록 조회
- 최신순 정렬

### 2.2 초기 화면 상태

- 모든 필터: 기본값("전체") 선택
- 검색어: 비어있음

---

## 3. 검색/필터 영역

### 3.1 필터 옵션

- 구매번호/자재명 검색 (텍스트 입력)
- 상태 전체 / 대기 / 승인 / 입고중 / 완료
- 공급사 전체 / 한화테크윈 / 하이크비전 등
- 기간 전체 / 이번 달 / 최근 3개월

---

## 4. 요약 영역

### 4.1 통계 표시

```
대기: 3건 | 승인: 5건 | 입고중: 2건 | 완료: 45건 | 총 구매 금액: 125,000,000원
```

### 4.2 [+ 새 구매] 버튼

**위치:** 페이지 헤더 영역

**클릭 시:**

- 구매 요청 등록 모달 오픈
- 폼 필드 초기화

---

## 5. 목록 테이블

### 5.1 컬럼 구조

| 컬럼명 | 표시 내용 | 비고 |
| --- | --- | --- |
| 구매 번호 | PO-2024-001 | 굵게 표시 |
| 공급사 | 한화테크윈 |  |
| 구매일 | 2024-01-20 |  |
| 금액 | 5,200,000원 |  |
| 입고 예정 | 2024-01-27 |  |
| 상태 | 뱃지 (승인/입고중/대기/완료) | 색상 구분 |
| 작업 | [상세] [입고] 또는 [상세] [승인] 링크 |  |

### 5.2 상태 뱃지

| 상태 | 색상 |
| --- | --- |
| 대기 | 주황색 |
| 승인 | 주황색 |
| 입고중 | 파란색 |
| 완료 | 초록색 |

### 5.3 작업 링크

- **대기 상태**: [상세] [승인]
- **승인/입고중 상태**: [상세] [입고]

---

## 6. 구매 요청 등록 모달

### 6.1 오픈 조건

- [+ 새 구매] 버튼 클릭

### 6.2 입력 필드

**선택 입력:**

- 발주 (선택): 연관 발주 선택 드롭다운

**필수 입력 (*):**

- 입고 예정일*

**구매 자재* (필수):**

- 자재 검색 입력 + [+ 추가] 버튼
- 추가된 자재 목록 테이블
    - 컬럼: 자재명 / 수량 / 단가 / 금액 / 삭제

**금액 요약:**

- 소계 (자동 계산)
- 부가세 10% (자동 계산)
- 합계 (자동 계산, 파란색 굵게)

**비고:**

- textarea, 특이사항 입력

### 6.3 [구매 요청] 버튼

**유효성 검증:**

- 입고 예정일 입력 확인
- 구매 자재 최소 1개 이상

**동작 순서:**

1. 필수 필드 검증
2. 구매 요청 등록
3. 구매 번호 자동 생성
4. 초기 상태: "대기"로 설정
5. 성공 알림
6. 모달 닫기, 목록 갱신

### 6.4 [취소] 버튼

- 모달 닫기, 변경사항 없음

---

## 7. 구매 상세 모달

### 7.1 오픈 조건

- 목록의 [상세] 링크 클릭

### 7.2 표시 정보

**기본 정보:**

- 구매 번호
- 상태 (뱃지)
- 공급사
- 담당자 (이름 + 연락처)
- 구매 일자
- 입고 예정일
- 입고 창고

**구매 자재 목록:**

| 컬럼 | 내용 |
| --- | --- |
| 자재명 | IP카메라 2MP |
| 수량 | 50개 |
| 단가 | 350,000원 |
| 금액 | 17,500,000원 |

**금액 요약:**

- 소계 / 부가세(10%) / 합계

### 7.3 버튼

- [입고 처리]: 입고 처리 모달 오픈
- [닫기]: 모달 닫기

---

## 8. 입고 처리 모달

### 8.1 오픈 조건

- 구매 목록의 [입고] 링크 클릭
- 구매 상세 모달의 [입고 처리] 버튼 클릭

### 8.2 표시 정보

**입고 자재 테이블:**

| 컬럼 | 내용 |
| --- | --- |
| 자재명 | IP카메라 2MP |
| 구매 수량 | 50 |
| 입고 수량 | 수량 입력 (편집 가능) |
| 로트 번호 | 로트 번호 입력 |

**입고 일시:**

- datetime-local, 기본값: 현재 일시

**입고 창고:**

- 드롭다운: 본사 창고 / 강남 창고 등

**비고:**

- 텍스트 입력

### 8.3 [입고 처리] 버튼

**동작 순서:**

1. 입고 수량 검증 (0 초과)
2. 입고 처리
3. 재고 자동 증가
4. 구매 상태 "완료"로 변경
5. 성공 알림: "입고 처리가 완료되었습니다! 입고 번호: IN-2024-050"
6. 모달 닫기, 목록 갱신

### 8.4 [취소] 버튼

- 모달 닫기, 변경사항 없음

---

## 9. 비즈니스 규칙

### 9.1 구매 번호 생성

- 자동 생성
- 형식: PO-YYYY-NNN (예: PO-2024-001)

### 9.2 금액 자동 계산

```
소계 = Σ(수량 × 단가)
부가세 = 소계 × 0.1
합계 = 소계 + 부가세
```

### 9.3 상태 흐름

```
대기 → 승인 → 입고중 → 완료
```

### 9.4 입고 처리 시 재고 연동

- 입고 수량만큼 해당 자재의 재고 자동 증가
- 입고 이력 자동 기록

---

## 10. 에러 처리

| 상황 | 메시지 |
| --- | --- |
| 필수 필드 누락 | "필수 항목을 입력해주세요." |
| 자재 미입력 | "구매 자재를 추가해주세요." |
| 입고 수량 오류 | "올바른 수량을 입력해주세요." |

---

## 11. 개발 체크리스트

### 11.1 필수 구현 사항

- [ ]  구매 목록 조회 및 필터링
- [ ]  구매 상세 조회
- [ ]  구매 요청 등록
- [ ]  입고 처리
- [ ]  금액 자동 계산 (소계/부가세/합계)

### 11.2 비즈니스 로직

- [ ]  구매 번호 자동 생성
- [ ]  입고 처리 시 재고 자동 증가
- [ ]  상태 흐름 관리

---

## 12. 관련 화면

- 발주 관리: 연관 발주 참조
- 입고 관리: 입고 처리 연동 (구매 입고)
- 재고 관리: 입고 시 재고 자동 증가

---
