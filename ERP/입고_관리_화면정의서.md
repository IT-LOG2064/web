# 입고 관리

## 1. 화면 개요

### 1.1 기본 정보

- **화면명**: 입고 관리
- **목적**: 입고 목록 조회/검색, 입고 상세 확인, 신규 입고 등록, 입고 검수 처리

---

## 2. 초기 로드

### 2.1 초기 데이터 로드

- 전체 입고 목록 조회
- 최신순 정렬
- 페이징 적용

### 2.2 초기 화면 상태

- 모든 필터: 기본값("전체") 선택
- 검색어: 비어있음
- 요약: 유형별 건수 표시

---

## 3. 검색/필터 영역

### 3.1 필터 옵션

- 유형 전체 / 구매 입고 / 현장 회수 / AS 입고 / 기타 입고
- 상태 전체 / 대기 / 검수중 / 완료
- 창고 전체 / 본사 창고 / 강남 창고 등

**검색 대상:**

- 입고번호 / 구매번호 / 자재명
- 통합 검색 (OR 조건)

**[초기화] 버튼:** 모든 필터 초기화 후 전체 재조회

---

## 4. 요약 영역

### 4.1 통계 표시

```
구매: 120건 | 현장 회수: 53건 | AS: 15건 | 기타: 8건
```

### 4.2 [+ 신규 입고] 버튼

**위치:** 요약 영역 우측

**클릭 시:**

- 신규 입고 등록 모달 오픈
- 폼 필드 초기화

---

## 5. 목록 테이블

### 5.1 컬럼 구조

| 컬럼명 | 표시 내용 | 비고 |
| --- | --- | --- |
| 입고 번호 | IN-2024-050 | 굵게 표시 |
| 유형 | 뱃지 (구매/현장 회수/AS) | 색상 구분 |
| 참조 번호 | PO-2024-001 | 링크 (클릭 시 상세) |
| 발주 | IT260115-01 | 링크 (클릭 시 상세) |
| 공급사/현장 | 한화테크윈 / 강남 오피스텔 |  |
| 입고일 | 2024-02-03 |  |
| 자재 | 2종 60개 |  |
| 창고 | 본사 |  |
| 상태 | 뱃지 (완료/검수중/대기) | 색상 구분 |
| 작업 | [검수] 버튼 (검수중 상태만) |  |

### 5.2 행 클릭

- 해당 입고의 상세 모달 오픈 (유형에 따라 다른 내용)

### 5.3 링크 클릭 (참조 번호, 발주)

- `event.stopPropagation()` - 행 클릭 이벤트 차단
- 해당 건의 상세 팝업 또는 화면으로 이동

### 5.4 유형 뱃지

| 유형 | 색상 |
| --- | --- |
| 구매 | 초록색 |
| 현장 회수 | 파란색 |
| AS | 주황색 |
| 기타 | 회색 |

### 5.5 상태 뱃지

**입고 상태 정의:**

- **대기**: 입고 등록 완료, 검수 대기 중
- **검수중**: 검수 진행 중 (모든 입고 유형에 검수 필요)
- **완료**: 검수 완료, 재고 반영 완료

**모든 입고 유형별 검수 목적:**

- **구매 입고**: 공급사로부터 받은 자재의 수량/품질 확인
- **현장 회수**: 회수된 자재의 상태 확인
- **AS 입고**: 고장/불량 자재의 문제 확인 및 분류
- **기타 입고**: 기타 입고 자재의 수량/상태 확인

**상태별 색상:**

| 상태 | 색상 |
| --- | --- |
| 대기 | 주황색 |
| 검수중 | 주황색 |
| 완료 | 초록색 |

### 5.6 페이지네이션

- ◀ 1 2 3 ▶

---

## 6. 입고 상세 모달

### 6.1 오픈 조건

- 목록 행 클릭

### 6.2 표시 정보 (유형별 상이)

**구매 입고 시:**

- 입고 번호, 유형, 상태, 구매번호, 발주번호, 공급사, 입고일, 창고

**현장 회수 시:**

- 입고 번호, 유형, 상태, 출고번호(참조), 발주번호, 현장명, 회수일, 창고

**AS 입고 시:**

- 입고 번호, 유형, 상태, AS번호, 발주번호, 현장명, 입고일, 창고

**공통 자재 목록:**

| 컬럼 | 내용 |
| --- | --- |
| 자재명 |  |
| 로트/시리얼 |  |
| 수량 |  |
| 검수 결과 |  |
| 입고 위치 |  |

### 6.3 버튼

- [입고증 출력]: 입고증 출력
- [닫기]: 모달 닫기

---

## 7. 신규 입고 등록 모달

### 7.1 오픈 조건

- [+ 신규 입고] 버튼 클릭

### 7.2 입력 필드

**입고 유형* (필수):**

- 라디오 버튼: 구매 입고 / 현장 회수 / 기타 입고
- 선택에 따라 참조 번호 레이블 동적 변경 (구매번호/출고번호 등)
- 선택에 따라 AS 입고 여부 컬럼 표시/숨김 처리

**본사/현장* (현장 회수 시만 표시, 필수):**

- 자동완성 검색 입력, 현장 목록
- 본사/현장 선택 시 [불러오기] 버튼 활성화

**참조 번호 (유형별 상이):**

- 구매 입고: 구매번호 드롭다운 + [불러오기] 버튼
- 현장 회수: 본사/현장 선택 후 [불러오기] 버튼으로 해당 현장의 발주 자재 자동 로드
- 기타 입고: 참조 번호 없음

**[불러오기] 버튼:**

- 참조 번호에 해당하는 자재 목록 자동 로드
- 현장 회수 시: 본사/현장 선택 전에는 버튼 비활성화

**회수 사유 (현장 회수 시만 표시, 필수):**

- 드롭다운: 미사용 / 고장 / 파손 / 과다출고
- 재고 관리 메뉴의 회수 사유 옵션과 동일

**입고일* (필수):**

- datetime-local, 기본값: 현재 시각

**입고 창고* (필수):**

- 드롭다운: 본사 창고 / AS 창고 등

**입고 자재* (필수):**

- 자재 검색 입력 (자동완성) 또는 [자재검색] 버튼으로 자재 추가
- 자재 목록 테이블:
    - 컬럼: 자재명 / 규격 / AS 입고 여부 / 수량 / 시리얼 / 삭제
    - AS 입고 여부 컬럼: 구매 입고 시 숨김, 현장 회수/기타 입고 시 표시
    - AS 입고 체크 시: 해당 자재는 AS 입고 수량으로 처리되어 AS 창고로 입고

**비고:**

- 텍스트 입력

### 7.3 AS 입고 처리 방식

- AS 입고는 별도 유형이 아니라, 현장 회수 시 자재별로 AS 여부를 체크하는 방식
- 현장 회수 입고 등록 시:
    - 각 자재 행에 "AS 입고 여부" 체크박스 표시
    - AS 체크된 자재는 AS 입고 수량으로 처리
    - AS 체크 안 된 자재는 일반 회수 수량으로 처리
- 입고 목록 테이블 표시:
    - 같은 입고 번호(IN-2024-049)라도 AS 입고와 일반 회수를 행으로 분리 표시
    - 예: IN-2024-049 [현장 회수] 3종 75개 본사창고
    - 예: IN-2024-049 [AS 입고] 2종 10개 AS창고

### 7.4 [입고 등록] 버튼

**유효성 검증:**

1. 입고 유형 선택 확인
2. 현장 회수 시: 본사/현장 선택 확인, 회수 사유 입력 확인
3. 입고일 입력 확인
4. 입고 창고 선택 확인
5. 입고 자재 최소 1개 이상

**동작 순서:**

1. 필수 필드 검증
2. 입고 등록 처리
3. 입고 번호 자동 생성
4. AS 입고 여부에 따라 창고 분리 처리
5. 재고 자동 증가
6. 성공 알림
7. 모달 닫기, 목록 갱신

### 7.5 [취소] 버튼

- 모달 닫기, 변경사항 없음

---

## 8. 자재 마스터 검색 모달

### 8.1 오픈 조건

- 신규 입고 등록 모달의 [자재검색] 버튼 클릭

### 8.2 필터 옵션

**대분류:**

- 드롭다운: 대분류 전체 / CCTV / 네트워크 / 케이블 / 부자재 / 기타

**소분류:**

- 드롭다운: 소분류 전체 / (대분류 선택 시 동적으로 옵션 변경)
- 대분류 미선택 시: 비활성화
- 대분류 선택 시: 해당 대분류의 소분류 목록 표시

**검색:**

- 자재 코드, 자재명, 규격으로 검색

**[초기화] 버튼:**

- 모든 필터 초기화

### 8.3 자재 목록

- 사용 중인 자재만 표시 (useYn = 'Y')
- 체크박스로 다중 선택 가능
- 전체 선택 체크박스 제공

### 8.4 [선택 자재 추가] 버튼

- 선택된 자재들을 입고 자재 목록에 추가
- 모달 닫기

---

## 9. 입고 검수 모달

### 9.1 오픈 조건

- 목록의 [검수] 버튼 클릭 (검수중 상태만 표시)

### 9.2 표시 정보

**참조 정보:**
- 구매번호, 공급사, 입고일 등

**자재별 검수 테이블:**

| 컬럼 | 내용 | 비고 |
| --- | --- | --- |
| 자재명 | 자재명 표시 |  |
| 입고 수량 | 입고된 수량 |  |
| 검수 결과 | 정상/일부불량/전량불량 선택 | 드롭다운 |
| 정상 | 정상 수량 입력 | 검수 결과에 따라 자동 입력/활성화 |
| 불량 | 불량 수량 입력 | 검수 결과에 따라 자동 입력/활성화 |
| 시리얼 | [시리얼 관리] 버튼 | 시리얼 자재만 표시 |

**검수 결과 선택 시 동작:**

1. **정상 선택 시:**
   - 정상 수량 = 입고 수량 (자동 입력)
   - 불량 수량 = 0 (자동 입력)
   - 정상/불량 입력 필드 비활성화

2. **일부불량 선택 시:**
   - 정상/불량 입력 필드 활성화
   - 사용자가 직접 수량 입력

3. **전량불량 선택 시:**
   - 정상 수량 = 0 (자동 입력)
   - 불량 수량 = 입고 수량 (자동 입력)
   - 정상/불량 입력 필드 비활성화

**검수 의견:**
- textarea, 전체 검수 의견 입력

### 9.3 시리얼 자재 검수

**[시리얼 관리] 버튼 클릭 시:**
- 검수 시리얼 관리 모달 오픈
- 입고 수량만큼 시리얼 행 자동 생성

**검수 시리얼 관리 모달:**

| 컬럼 | 내용 |
| --- | --- |
| 시리얼 번호 | 시리얼 번호 입력 (자동 생성 가능) |
| 검수 결과 | 정상/불량 선택 |
| 비고 | 불량 사유 입력 |

**기능:**
- [확인]: 시리얼별 검수 결과를 집계하여 검수 모달의 정상/불량 수량에 반영

**시리얼 검수 완료 시:**
- 정상 시리얼 개수 → 정상 수량
- 불량 시리얼 개수 → 불량 수량
- 검수 결과 자동 선택 (정상/일부불량/전량불량)

### 9.4 [검수 완료] 버튼

**동작:**

1. 검수 결과 저장
2. 입고 상태 "완료"로 변경
3. 불량 수량 처리 (별도 이력 기록)
4. 시리얼 자재의 경우 시리얼별 검수 결과 저장
5. 성공 알림
6. 모달 닫기, 목록 상태 갱신

### 9.5 [취소] 버튼

- 모달 닫기, 변경사항 없음

---

## 10. 시리얼 선택 모달

### 10.1 오픈 조건

- 신규 입고 등록 시 시리얼 관리 대상 자재의 시리얼 입력 필요 시

### 10.2 표시 정보

- 자재명 표시
- 시리얼 번호 입력 목록
- 수량에 맞게 시리얼 번호 입력

---

## 11. 비즈니스 규칙

### 11.1 입고 번호 생성

- 자동 생성
- 형식: IN-YYYY-NNN (예: IN-2024-050)

### 11.2 재고 연동

- 입고 등록 시 해당 자재 재고 자동 증가
- 창고별 위치 업데이트
- AS 입고 체크된 자재는 AS 창고로 입고

### 11.3 유형별 참조

| 입고 유형 | 참조 | 재고 처리 | 비고 |
| --- | --- | --- | --- |
| 구매 입고 | 구매번호 | 신품 재고 증가 | 공급사 정보 자동 연동 |
| 현장 회수 | 출고번호 | 중고/신품 재고 증가 | 회수 사유 필수 기록 |
| 현장 회수 (AS) | 출고번호 | AS창고 재고 증가 | 자재별 AS 체크 시 |
| 기타 입고 | - | 지정 창고 재고 증가 | 참조 문서 없음 |

### 11.4 현장 회수 시

- 회수 사유 필수 기록 (미사용 / 고장 / 파손 / 과다출고)
- 현장 출고 현황에 회수 이력 반영
- 자재별 AS 입고 여부 체크 가능
- AS 입고와 일반 회수가 혼합된 경우, 입고 목록에서 행을 분리하여 표시

### 11.5 구매 입고 시

- 본사/현장 선택 필드 숨김 처리

### 11.6 기타 입고 시

- 본사/현장 선택 불필요
- 참조 번호 없음

---

## 12. 에러 처리

| 상황 | 메시지 |
| --- | --- |
| 필수 필드 누락 | "필수 항목을 입력해주세요." |
| 자재 미추가 | "입고 자재를 추가해주세요." |
| 수량 오류 | "올바른 수량을 입력해주세요." |
| 참조 번호 없음 | "해당 번호를 찾을 수 없습니다." |

---

## 13. 개발 체크리스트

### 13.1 필수 구현 사항

- [ ]  입고 목록 조회 및 필터링 (유형/상태/창고)
- [ ]  입고 상세 조회 (유형별 다른 표시)
- [ ]  신규 입고 등록 (유형별 다른 폼)
- [ ]  참조 번호로 자재 자동 불러오기
- [ ]  자재 마스터 검색 모달 (대분류/소분류 2단계 필터)
- [ ]  AS 입고 여부 체크 기능 (현장 회수 시)
- [ ]  AS 입고와 일반 회수 행 분리 표시
- [ ]  입고 검수 처리 (모든 입고 유형)
- [ ]  검수 결과에 따른 정상/불량 수량 자동 처리
- [ ]  시리얼 자재 검수 (시리얼별 정상/불량 선택)
- [ ]  입고증 출력
- [ ]  시리얼 선택 기능
- [ ]  페이지네이션

### 13.2 비즈니스 로직

- [ ]  입고 번호 자동 생성
- [ ]  입고 시 재고 자동 증가
- [ ]  유형별 참조 데이터 연동
- [ ]  회수 사유 기록 (현장 회수 시)
- [ ]  AS 입고 체크 시 AS 창고로 입고 처리
- [ ]  검수 완료 시 상태 자동 변경 (검수중 → 완료)

---

## 14. 관련 화면

- 구매 관리: 구매 입고 연동
- 출고 관리: 현장 회수 시 출고 번호 참조
- AS 관리: AS 입고 연동
- 재고 관리: 입고 시 재고 자동 업데이트

---
