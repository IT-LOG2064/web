# 재고 관리

## 1. 화면 개요

### 1.1 기본 정보

- **화면명**: 재고 관리
- **목적**: 자재별 재고 현황 조회, 시리얼 단위 재고 관리, 재고 변동 이력 확인, 재고 실사

---

## 2. 탭 구성

4개의 탭으로 구성됨:

- **탭 1: 재고 현황** (기본)
- **탭 2: 시리얼 재고 현황**
- **탭 3: 재고 변동 이력**
- **탭 4: 재고 실사**

---

## 3. 탭 1: 재고 현황

### 3.1 초기 로드

- 전체 자재 재고 목록 조회
- 자재코드 기준 정렬

### 3.2 검색/필터 영역

**필터 옵션:**

- 카테고리 전체 / CCTV / 네트워크 등
- 창고 전체 / 본사 창고 / 강남 창고 등
- 상태 전체 / 정상 / 안전재고 미달 / 예약 초과
- 키워드 검색 (자재명/코드)
- [안전재고 미달만] 체크박스 필터

**[초기화] 버튼:** 모든 필터 초기화 후 전체 재조회

### 3.3 요약 영역

```
총 자재: 1,234개 | 총 재고: 15,678개 | 안전재고 미달: 8개 | 가용 재고: 14,523개
```

**버튼:**

- [재고 조정]: 재고 조정 모달 오픈
- [Excel 다운로드]: 현재 목록 엑셀 다운로드

### 3.4 목록 테이블

**컬럼 구조:**

| 컬럼명 | 표시 내용 | 비고 |
| --- | --- | --- |
| 자재 코드 | CAM-001 | 굵게 표시 |
| 자재명 | IP카메라 2MP |  |
| 규격 | 2MP, IP67 | 작은 텍스트, 회색 |
| 창고 위치 | 본사 A-01-01 |  |
| 재고 (신품/중고) | 25 / 신품 20 · 중고 5 | 합계 굵게, 세부 작은 텍스트 |
| 예약 | 5 | 출고 예약된 수량 |
| 가용 | 20 | 총재고 - 예약 |
| 상태 | 뱃지 (정상/안전재고 미달) | 색상 구분 |
| 작업 | [조정] 버튼 |  |

**행 클릭:** 재고 상세 모달 오픈

**[조정] 버튼 클릭:** 재고 조정 모달 오픈 (해당 자재 선택됨)

### 3.5 상태 뱃지

**3단계 상태 구분:**

| 상태 | 조건 | 색상 | 의미 |
| --- | --- | --- | --- |
| 정상 | 가용 재고 >= 안전재고 | 초록색 | 예약 제외 후에도 안전재고 이상 확보 |
| 안전재고 미달 | 0 <= 가용 재고 < 안전재고 | 주황색 | 예약은 충족 가능하지만 안전재고 미달, 추가 입고 필요 |
| 예약 초과 | 가용 재고 < 0 | 빨간색 | 예약된 수량을 충족할 수 없는 심각한 상황, 즉시 입고 또는 발주 취소 필요 |

**예약 초과 상태 표시:**

- 가용 재고 컬럼: 빨간색 굵은 글씨로 음수 표시 (예: -3)

---

## 4. 탭 2: 시리얼 재고 현황

### 4.1 검색/필터 영역

**필터 옵션:**

- 자재명 / 시리얼번호 검색
- 상태 필터 (정상 / 외관파손 / 기능불량 / 완전파손 / 분실 / 폐기)
- 현장 필터

### 4.2 목록 테이블

**컬럼 구조:**

| 컬럼명 | 표시 내용 |
| --- | --- |
| 시리얼 번호 | CAM-2024-001 |
| 자재코드 | CAM-001 |
| 자재명 | IP카메라 2MP |
| 상태 | 뱃지 (정상/외관파손 등) |
| 현재 위치 | 본사 창고 A-01-01 |
| 현장 | 강남 오피스텔 또는 - |
| 입고일 | 2024-01-15 |
| 작업 | [상태변경] 버튼 |

**행 클릭:** 시리얼 상세 모달 오픈

### 4.3 시리얼 상태 뱃지

| 상태 | 색상 |
| --- | --- |
| 정상 | 초록색 |
| 외관 파손 | 주황색 |
| 기능 불량 | 빨간색 |
| 완전 파손 | 빨간색 |
| 분실 | 파란색 |
| 폐기 | 회색 |

---

## 5. 탭 3: 재고 변동 이력

### 5.1 검색/필터 영역

**필터 옵션:**

- 기간 (시작일 ~ 종료일)
- 유형 전체 / 입고 / 출고 / 회수 / 재출고 / 파손 / 분실
- 소유구분 전체 / 소유 / 임대 / 현장전용
- 품질 전체 / 신품 / 중고
- 자재명/시리얼 검색
- 현장 필터

### 5.2 요약 영역

```
입고: 120건 | 출고: 85건 | 회수: 23건 | 재출고: 8건 | 파손/분실: 5건
```

### 5.3 목록 테이블

**컬럼 구조:**

| 컬럼명 | 표시 내용 |
| --- | --- |
| 일시 | 2024-02-03 14:00 |
| 이동유형 | 뱃지 (입고/출고/회수 등) |
| 자재명 | IP카메라 2MP |
| 수량 | 50개 |
| 이동구간 | 한화테크윈 → 본사창고 |
| 참조번호 | 연결 링크 (PO-2024-001, IT260115-01, AS-2024-001 등) |
| 사유/상태 | 이동 사유 또는 시리얼 상태 변경 내역 |
| 담당자 | 김창고 |

**참조번호 클릭:**

- 현재 화면 유지한 채 해당 문서의 상세 모달 오픈
- 참조번호 유형별 동작:
  - PO-YYYY-NNN (구매 번호) → 구매 상세 모달
  - IT-YYMMDD-NN (발주 번호) → 발주 상세 모달
  - IN-YYYY-NNN (입고 번호) → 입고 상세 모달
  - OUT-YYYY-NNN (출고 번호) → 출고 상세 모달
  - AS-YYYY-NNN (AS 번호) → AS 상세 모달
- 모달 닫으면 재고 변동 이력 화면으로 복귀

**사유/상태 컬럼 표시 규칙:**

- 입고: "-" (사유 없음)
- 출고: "-" (사유 없음)
- 회수: 회수 사유 (미사용, 고장 등)
- AS입고: 문제 유형 (초기불량, 파손 등)
- 재출고: 처리 결과 (수리완료 등)
- 분실: 분실 사유 (현장분실 등)
- 파손: 파손 사유 (외관파손 등)
- 재고조정: 조정 사유 (실사, 분실, 파손, 오입력 등)

**사유/상태 데이터 입력 출처:**

| 이동유형 | 입력 화면 | 입력 필드 | 비고 |
| --- | --- | --- | --- |
| 입고 (구매) | 입고 관리 > 입고 등록 | - | 사유 불필요 |
| 입고 (현장회수) | 입고 관리 > 입고 등록 | 회수 사유 (필수) | 미사용, 고장, 파손 등 |
| 출고 | 출고 관리 > 출고 등록 | - | 사유 불필요 |
| AS입고 | AS 관리 > AS 접수 | 문제 유형 (필수) | 초기불량, 고장, 파손 등 |
| AS재출고 | 출고 관리 > 출고 등록 > AS 출고자재 선택 | 교체출고 여부 | 교체출고, 재출고 등 |
| 재고조정 | 재고 관리 > 재고 조정 | 조정 사유 (필수) | 실사, 분실, 파손, 오입력 등 |

**주의:**

- 재고 변동 이력 탭은 조회 전용
- 사유/상태는 각 업무 화면에서 입력받아 자동 기록
- 이력에서 직접 수정 불가

**이동유형 뱃지:**

| 유형 | 색상 |
| --- | --- |
| 입고 | 초록색 |
| 출고 | 파란색 |
| 회수 | 파란색 |
| AS입고 | 주황색 |
| 재출고 | 보라색 |
| 분실 | 빨간색 |
| 파손 | 주황색 |

**페이지네이션:** ◀ 1 2 3 ▶

---

## 6. 탭 4: 재고 실사

- 재고 실사 기능 (TODO: 상세 기획 필요)

---

## 7. 시리얼 상세 모달

### 7.1 오픈 조건

- 시리얼 재고 현황 탭의 행 클릭

### 7.2 표시 정보

**기본 정보:**

- 시리얼 번호
- 자재 코드
- 자재명
- 제조사
- 현재 상태 (뱃지)
- 현재 위치
- 현장
- 입고일

**이동 이력 (타임라인):**

- 일시, 이동 유형, 담당자, 출처→목적지 표시

### 7.3 버튼

- [상태 변경]: 시리얼 상태 변경 모달 오픈
- [닫기]: 모달 닫기

---

## 8. 시리얼 상태 변경 모달

### 8.1 오픈 조건

- 시리얼 목록의 [상태변경] 버튼 클릭
- 시리얼 상세 모달의 [상태 변경] 버튼 클릭

### 8.2 표시 정보 (읽기 전용)

- 시리얼 번호
- 자재명
- 현재 상태

### 8.3 입력 필드

**변경할 상태 (라디오 버튼 - 필 형태):**

- 정상 / 외관 파손 / 기능 불량 / 완전 파손 / 분실 / 폐기

**변경 사유* (필수):**

- textarea, 3줄

**변경 일시:**

- datetime-local, 기본값: 현재 일시

### 8.4 [상태 변경] 버튼

**유효성 검증:**

1. 변경할 상태 선택 확인
2. 변경 사유 입력 확인

**동작 순서:**

1. 검증 통과
2. 상태 변경 처리
3. 이동 이력 기록
4. 성공 알림
5. 모달 닫기, 목록 갱신

### 8.5 [취소] 버튼

- 모달 닫기, 변경사항 없음

---

## 9. 재고 조정 모달

### 9.1 오픈 조건

**경로 1: 요약 영역 [재고 조정] 버튼 클릭**

- 자재 마스터 검색 모달 오픈
- 조정할 자재를 선택

**경로 2: 목록의 [조정] 버튼 클릭**

- 해당 자재 정보가 자동 입력된 재고 조정 모달 바로 오픈
- 자재 마스터 검색 단계 생략

### 9.2 자재 마스터 검색 모달 (경로 1)

**검색/필터:**

- 카테고리 필터 (전체/CCTV/네트워크/케이블/부자재)
- 키워드 검색 (자재 코드, 자재명, 규격)
- [초기화] 버튼

**목록 테이블:**

| 컬럼명 | 표시 내용 |
| --- | --- |
| 자재 코드 | CAM-001 |
| 카테고리 | CCTV |
| 자재명 / 규격 | IP카메라 2MP / 2MP, IP67 |
| 현재 재고 | 25개 |
| 단위 | 개 |
| 선택 | [조정] 버튼 |

**[조정] 버튼 클릭:**

- 해당 자재 정보를 재고 조정 모달에 전달
- 자재 마스터 검색 모달 닫기
- 재고 조정 모달 오픈

### 9.3 재고 조정 모달 입력 필드

**자재 정보 (읽기 전용):**

- 자재 코드
- 자재명
- 현재 재고
- 창고
- 위치

**조정 유형* (필수):**

- 증가 (+) / 감소 (-) / 재고 설정 (=)

**조정 수량* (필수):**

- 숫자 입력, 최소 1

**조정 사유* (필수):**

- 실사 조정 / 분실 / 파손 / 오입력 수정 / 기타

**상세 사유:**

- textarea, 3줄

**조정 일시:**

- datetime-local, 기본값: 현재 일시

### 9.4 [조정 완료] 버튼

**동작:**

1. 필수 필드 검증
2. 재고 수량 조정 처리
3. 재고 변동 이력 기록
4. 예약 수량은 변동 없음 (재고 조정과 무관)
5. 조정 후 총 재고 < 예약 수량 가능 (가용 재고 음수 표시)
6. 성공 알림
7. 모달 닫기, 목록 갱신

### 9.5 [취소] 버튼

- 모달 닫기, 변경사항 없음

---

## 10. 재고 상세 모달

### 10.1 오픈 조건

- 재고 현황 탭의 행 클릭

### 10.2 표시 정보

- 자재 기본 정보
- 창고별 재고 현황
- 신품/중고 구분 재고
- 예약/가용 수량

---

## 11. 비즈니스 규칙

### 11.1 가용 재고 계산

```
가용 재고 = 총 재고 - 예약 수량
```

**음수 가능:**

- 재고 조정으로 총 재고 < 예약 수량 상황 발생 가능
- 가용 재고 음수 표시 (예: -2개)
- 이 경우 "예약 초과" 또는 "재고 부족" 상태 표시 권장

### 11.2 재고 상태 판단 (3단계)

**1. 정상**

```
가용 재고 >= 안전재고
```

- 예약을 제외하고도 안전재고 이상 확보
- 초록색 뱃지

**2. 안전재고 미달**

```
0 <= 가용 재고 < 안전재고
```

- 예약은 충족 가능하지만 안전재고 미달
- 추가 입고 필요
- 주황색 뱃지

**3. 예약 초과 (심각)**

```
가용 재고 < 0
```

- 예약된 수량을 충족할 수 없는 심각한 상황
- 즉시 입고 또는 발주 취소 필요
- 빨간색 뱃지
- 가용 재고 빨간색 굵은 글씨

**예시:**

- 총 10개, 예약 5개, 가용 5개, 안전재고 3개 → **정상**
- 총 10개, 예약 8개, 가용 2개, 안전재고 3개 → **안전재고 미달**
- 총 10개, 예약 11개, 가용 -1개, 안전재고 3개 → **예약 초과**

### 11.3 재고 조정과 예약 수량

- 재고 조정 시 예약 수량은 변동 없음
- 재고 조정은 물리적 재고 수량만 변경
- 예약 수량은 발주 등록/취소 시에만 변동

### 11.4 재고 조정 이력

- 모든 조정 건은 재고 변동 이력에 자동 기록
- 조정 전/후 수량, 조정자, 조정일시 저장

### 11.5 시리얼 상태 변경 시 위치 처리

- 분실 상태: 위치 "-" 표시
- 폐기 상태: 위치 "-" 표시
- 기타 상태: 현재 위치 유지

---

## 12. 에러 처리

| 상황 | 메시지 |
| --- | --- |
| 필수 필드 누락 | "필수 항목을 입력해주세요." |
| 상태 미선택 | "변경할 상태를 선택해주세요." |
| 수량 입력 오류 | "1 이상의 수량을 입력해주세요." |

---

## 13. 개발 체크리스트

### 13.1 필수 구현 사항

- [ ]  재고 현황 목록 조회 및 필터링
- [ ]  시리얼 재고 현황 조회
- [ ]  재고 변동 이력 조회
- [ ]  재고 조정 (증가/감소/설정)
- [ ]  시리얼 상태 변경
- [ ]  재고 상세 조회
- [ ]  Excel 다운로드

### 13.2 비즈니스 로직

- [ ]  가용 재고 자동 계산
- [ ]  안전재고 미달 판단
- [ ]  재고 변동 이력 자동 기록
- [ ]  시리얼 이동 이력 관리

---

## 14. 관련 화면

- 입고 관리: 입고 시 재고 자동 증가
- 출고 관리: 출고 시 재고 자동 감소
- AS 관리: AS 처리에 따른 시리얼 상태 변경
- 자재 정보: 자재 마스터 데이터 참조

---
